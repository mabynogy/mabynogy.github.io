<!doctype html><html><head><meta charset="utf-8"><title>to-tree</title></head><body><script src="/spa-mabynogy.js"></script><pre>fn to_tree x
 check is_arr x
 
 fn get_children x y
  check is_obj x
  check is_arr y
  
  let r arr
  let id x.id
  
  forof y
   if is_null v.parent
    cont
    
   if different v.parent.id id
    cont
    
   let children get_children v y
   
   assign v.children children      
   push r v
  end
  
  ret r
 end
 
 let r arr
 
 forof x
  if not is_null v.parent
   cont
  
  let children get_children v x
  
  assign v.children children
  push r v
 end 
 
 ret r
end</pre></body></html>